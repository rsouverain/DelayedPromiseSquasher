'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var DelayedPromiseSquasher=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:450;_classCallCheck(this,a),this._delayMs=b,this._isEnabled=!0,this._lastCallableRandId=null,this._sequence=0}return _createClass(a,[{key:'push',value:function push(a){var b=this,c=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(!c&&!this.isEnabled)return sayServiceDisabled(this),Promise.reject();if('function'==typeof a){var d=new Date,e=this._sequence+.01;this._sequence=e;var f=new Promise(function(b){b({callable:a,date:d,sequence:e})});return f.then(delayPromise(this._delayMs)).then(function(a){if(!c&&!b.isEnabled)sayServiceDisabled(b);else if(c||b.isEnabled&&a.sequence===b._sequence)return b._sequence=null,a.callable();return Promise.resolve(null)})}return console.error('callable must be a function'),Promise.reject()}},{key:'isEnabled',get:function get(){return this._isEnabled},set:function set(a){this._isEnabled=a}}]),a}(),delayPromise=function(a){return function(){for(var b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];return new Promise(function(b){setTimeout(function(){b.apply(void 0,c)},a)})}},sayServiceDisabled=function(a){console.error('Service is disabled (DelayedPromiseSquasher) ',a)};module.exports=DelayedPromiseSquasher;